@import './styles/index.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/**
 * === DESIGN TOKEN USAGE GUIDE ===
 *
 * This file defines CSS custom properties following shadcn conventions.
 * All components should use these semantic tokens instead of hardcoded colors.
 *
 * COLOR TOKEN CATEGORIES:
 *
 * 1. CORE SEMANTIC (use for UI elements):
 *    - bg-background / text-foreground    → Page/app background and text
 *    - bg-card / text-card-foreground     → Card surfaces
 *    - bg-popover / text-popover-foreground → Floating elements (dropdowns, tooltips)
 *    - bg-muted / text-muted-foreground   → Subtle backgrounds, secondary text
 *    - bg-accent / text-accent-foreground → Hover states, emphasis (NOT for status)
 *    - border-border                      → All borders
 *    - bg-input                           → Form input backgrounds
 *    - ring-ring                          → Focus rings
 *
 * 2. INTERACTIVE (use for buttons, links):
 *    - bg-primary / text-primary-foreground → Primary actions (CTA buttons)
 *    - bg-secondary / text-secondary-foreground → Secondary actions
 *
 * 3. FEEDBACK/STATUS (use for state indication):
 *    - bg-success / text-success          → Completed, active, positive
 *    - bg-warning / text-warning          → Pending, caution, needs attention
 *    - bg-info / text-info                → Informational, in-progress
 *    - bg-destructive / text-destructive  → Errors, critical, blocked
 *
 * 4. AGENT STATUS (use for agent indicators):
 *    - bg-status-online                   → Running/active agents
 *    - bg-status-offline                  → Stopped/error agents
 *    - bg-status-pending                  → Starting/transitioning
 *    - bg-status-idle                     → Idle/waiting agents
 *
 * USAGE EXAMPLES:
 *    BAD bg-green-500 text-green-500      → Hardcoded, won't adapt to themes
 *    OK  bg-success text-success          → Uses semantic tokens
 *
 *    BAD bg-red-500/10 text-red-500       → Hardcoded
 *    OK  bg-destructive/10 text-destructive → Semantic with opacity
 *
 *    BAD border-amber-500                 → Hardcoded
 *    OK  border-warning                   → Semantic
 *
 * All tokens support opacity via Tailwind: bg-success/10, text-warning/80, etc.
 * Tokens are defined in both :root (light) and .dark (dark) for theme support.
 */

@layer base {
	:root {
		/* === Gas Town Design System === */
		/* Primary: #EF6F2E | Accent: #6A7282 | Background: #F8F8F8 | Text: #020202 */

		/* Core colors */
		--background: 0 0% 97%;
		--foreground: 0 0% 1%;
		--card: 0 0% 100%;
		--card-foreground: 0 0% 1%;
		--popover: 0 0% 100%;
		--popover-foreground: 0 0% 1%;
		--primary: 11 100% 50%;            /* #F97316 CTA orange */
		--primary-foreground: 0 0% 7%;     /* Near-black for AA contrast on orange */
		--secondary: 220 10% 92%;
		--secondary-foreground: 0 0% 1%;
		--muted: 220 10% 92%;
		--muted-foreground: 220 10% 40%;
		--accent: 220 10% 46%;
		--accent-foreground: 0 0% 100%;
		--destructive: 0 90% 56%;          /* #EF4444 error red */
		--destructive-foreground: 0 0% 100%;  /* White has 4.35:1 contrast on this red */
		--border: 220 10% 85%;
		--input: 220 10% 88%;
		--ring: 18 86% 56%;
		--radius: 0.5rem;

		/* === Typography === */
		--font-sans: 'Inter', sans-serif;
		--font-display: 'Space Grotesk', sans-serif;
		--font-mono: 'JetBrains Mono', monospace;

		/* === Spacing Scale (based on 4px grid) === */
		--space-1: 0.25rem;  /* 4px */
		--space-2: 0.5rem;   /* 8px */
		--space-3: 0.75rem;  /* 12px */
		--space-4: 1rem;     /* 16px */
		--space-5: 1.25rem;  /* 20px */
		--space-6: 1.5rem;   /* 24px */
		--space-7: 1.75rem;  /* 28px */
		--space-8: 2rem;     /* 32px */
		--space-9: 2.25rem;  /* 36px */
		--space-10: 2.5rem;  /* 40px */
		--space-11: 2.75rem; /* 44px */
		--space-12: 3rem;    /* 48px */

		/* === Animation Tokens === */
		--duration-instant: 50ms;
		--duration-fast: 150ms;
		--duration-normal: 200ms;
		--duration-slow: 300ms;
		--duration-slower: 500ms;
		--ease-out: cubic-bezier(0.16, 1, 0.3, 1);
		--ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
		--ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
		--delay-stagger: 50ms;

		/* === Semantic Feedback Colors (HSL) === */
		/* Success: #22C55E, Warning: #F59E0B, Error: #EF4444, Info: #3B82F6 */
		--success: 142 71% 45%;            /* #22C55E green */
		--success-foreground: 0 0% 100%;
		--warning: 38 92% 50%;             /* #F59E0B amber */
		--warning-foreground: 0 0% 1%;
		--info: 217 91% 60%;               /* #3B82F6 blue */
		--info-foreground: 0 0% 100%;

		/* === Status Colors (HSL) === */
		--status-online: 142 71% 45%;      /* #22C55E green (success) */
		--status-offline: 0 90% 56%;       /* #EF4444 red (error) */
		--status-pending: 38 92% 50%;      /* #F59E0B amber (warning) */
		--status-idle: 217 91% 60%;        /* #3B82F6 blue (info) */

		/* === Shadow Tokens (5-Level System) === */
		--shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.03);
		--shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.04), 0 1px 2px -1px rgb(0 0 0 / 0.04);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.05);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.04);
		--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.08), 0 8px 10px -6px rgb(0 0 0 / 0.04);
		--shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.15);
		--shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
		--shadow-glow: 0 0 20px -5px hsl(var(--primary) / 0.4);
		--shadow-focus: 0 0 0 3px hsl(var(--ring) / 0.25);

		/* === Surface Gradients (for depth) === */
		--gradient-surface: linear-gradient(180deg, hsl(var(--card)) 0%, hsl(var(--card) / 0.95) 100%);
		--gradient-surface-subtle: linear-gradient(180deg, transparent 0%, hsl(var(--muted) / 0.05) 100%);
		--gradient-border: linear-gradient(135deg, hsl(var(--border) / 0.8) 0%, hsl(var(--border) / 0.4) 100%);
		--gradient-shine: linear-gradient(135deg, hsl(0 0% 100% / 0.1) 0%, transparent 50%);
		--gradient-overlay: linear-gradient(180deg, transparent 0%, hsl(var(--background) / 0.8) 100%);

		/* === Touch Target (WCAG 2.5.5 AAA: 44px, enhanced: 48px) === */
		--touch-target-min: 48px;
		--touch-gap-min: 8px;
	}

	.dark {
		/* === Gas Town Dark Industrial Theme === */
		/* Based on: gas-black #050a09, gas-dark #0B1210, gas-surface #131F1C */
		--background: 163 24% 6%;          /* gas-dark: #0B1210 */
		--foreground: 0 0% 91%;            /* gas-text: #E8E8E8 */
		--card: 165 24% 10%;               /* gas-surface: #131F1C */
		--card-foreground: 0 0% 91%;       /* gas-text: #E8E8E8 */
		--popover: 165 24% 10%;            /* gas-surface: #131F1C */
		--popover-foreground: 0 0% 91%;    /* gas-text: #E8E8E8 */
		--primary: 11 100% 50%;            /* #F97316 CTA orange */
		--primary-foreground: 168 33% 3%;  /* gas-black: #050a09 */
		--secondary: 169 24% 13%;          /* gas-surfaceHighlight: #1A2A27 */
		--secondary-foreground: 0 0% 91%;  /* gas-text: #E8E8E8 */
		--muted: 169 24% 13%;              /* gas-surfaceHighlight: #1A2A27 */
		--muted-foreground: 220 10% 46%;   /* gas-muted: #6A7282 */
		--accent: 217 91% 60%;             /* gas-accent: #3B82F6 */
		--accent-foreground: 0 0% 91%;     /* gas-text: #E8E8E8 */
		--destructive: 0 90% 56%;          /* #EF4444 error red */
		--destructive-foreground: 0 0% 91%;
		--border: 165 16% 20%;             /* gas-border: #2A3A36 */
		--input: 169 24% 13%;              /* gas-surfaceHighlight: #1A2A27 */
		--ring: 11 100% 50%;               /* #F97316 CTA orange */

		/* === Gas Town Industrial Tokens === */
		--gas-surface: 0 0% 8%;
		--gas-border: 0 0% 20%;
		--gas-primary: 11 100% 50%;        /* #F97316 */
		--gas-error: 0 90% 56%;            /* #EF4444 */

		--success: 142 71% 45%;            /* #22C55E green */
		--success-foreground: 0 0% 100%;
		--warning: 38 92% 50%;             /* #F59E0B amber */
		--warning-foreground: 0 0% 1%;
		--info: 217 91% 60%;               /* #3B82F6 blue */
		--info-foreground: 0 0% 100%;

		/* === Dark Mode Shadow Tokens (5-Level System, Deeper for Industrial Feel) === */
		--shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.4);
		--shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.5), 0 1px 2px -1px rgb(0 0 0 / 0.5);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.6), 0 2px 4px -2px rgb(0 0 0 / 0.5);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.6), 0 4px 6px -4px rgb(0 0 0 / 0.5);
		--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.6), 0 8px 10px -6px rgb(0 0 0 / 0.5);
		--shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.7);
		--shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.4);
		--shadow-glow: 0 0 30px -5px hsl(var(--primary) / 0.5);

		/* === Dark Mode Surface Gradients === */
		--gradient-surface: linear-gradient(180deg, hsl(var(--card)) 0%, hsl(var(--card) / 0.9) 100%);
		--gradient-surface-subtle: linear-gradient(180deg, transparent 0%, hsl(0 0% 100% / 0.02) 100%);
		--gradient-border: linear-gradient(135deg, hsl(var(--border) / 0.6) 0%, hsl(var(--border) / 0.2) 100%);
		--gradient-shine: linear-gradient(135deg, hsl(0 0% 100% / 0.05) 0%, transparent 50%);
		--gradient-overlay: linear-gradient(180deg, transparent 0%, hsl(var(--background) / 0.9) 100%);
	}
}

@layer base {
	* {
		@apply border-border;
	}

	body {
		@apply bg-background text-foreground;
		font-family: var(--font-sans);
		font-feature-settings: 'rlig' 1, 'calt' 1;
	}

	/* Headers use Space Grotesk display font */
	h1, h2, h3, h4, h5, h6, .font-display {
		font-family: var(--font-display);
		font-weight: 600;
	}

	code, pre, .font-mono {
		font-family: var(--font-mono);
	}
}

/* === Typography Utility Classes === */
@layer utilities {
	/* Numeric Typography (tabular figures for aligned numbers) */
	.tabular-nums {
		font-variant-numeric: tabular-nums;
	}

	.proportional-nums {
		font-variant-numeric: proportional-nums;
	}

	.oldstyle-nums {
		font-variant-numeric: oldstyle-nums;
	}

	.lining-nums {
		font-variant-numeric: lining-nums;
	}

	/* Numeric utilities for dashboards/stats */
	.numeric {
		font-family: var(--font-mono);
		font-variant-numeric: tabular-nums;
		font-feature-settings: 'tnum' 1;
	}

	/* Truncate utilities */
	.line-clamp-1 {
		display: -webkit-box;
		-webkit-line-clamp: 1;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-3 {
		display: -webkit-box;
		-webkit-line-clamp: 3;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	/* Text balance for headlines */
	.text-balance {
		text-wrap: balance;
	}

	.text-pretty {
		text-wrap: pretty;
	}
}

/* === Surface Gradient Utilities === */
@layer utilities {
	/* Apply surface gradients for depth */
	.gradient-surface {
		background: var(--gradient-surface);
	}

	.gradient-surface-subtle {
		background: var(--gradient-surface-subtle);
	}

	.gradient-shine {
		position: relative;
	}

	.gradient-shine::before {
		content: '';
		position: absolute;
		inset: 0;
		background: var(--gradient-shine);
		border-radius: inherit;
		pointer-events: none;
	}

	.gradient-overlay {
		background: var(--gradient-overlay);
	}

	/* Gradient border (for subtle depth effect) */
	.gradient-border {
		position: relative;
		background: hsl(var(--card));
		border-radius: var(--radius);
	}

	.gradient-border::before {
		content: '';
		position: absolute;
		inset: 0;
		padding: 1px;
		background: var(--gradient-border);
		border-radius: inherit;
		-webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		-webkit-mask-composite: xor;
		mask-composite: exclude;
		pointer-events: none;
	}
}

/* === Glass Morphism Utilities === */
@layer components {
	/* Standard glass panel - subtle blur with semi-transparent background */
	.panel-glass {
		@apply bg-background/80 backdrop-blur-xl border border-border rounded-lg;
	}

	/* Strong glass panel - more pronounced blur effect */
	.panel-glass-strong {
		@apply bg-background/90 backdrop-blur-2xl border border-border rounded-lg;
	}

	/* Glass card variant - for elevated surfaces */
	.card-glass {
		@apply bg-card/80 backdrop-blur-xl border border-border rounded-lg shadow-md;
	}

	/* Glass popover variant - for floating elements */
	.popover-glass {
		@apply bg-popover/85 backdrop-blur-xl border border-border rounded-lg shadow-lg;
	}

	/* Fallback for browsers without backdrop-filter support (checks both standard and webkit) */
	@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
		.panel-glass {
			@apply bg-background/95 border border-border rounded-lg;
		}

		.panel-glass-strong {
			@apply bg-background border border-border rounded-lg;
		}

		.card-glass {
			@apply bg-card/95 border border-border rounded-lg shadow-md;
		}

		.popover-glass {
			@apply bg-popover/95 border border-border rounded-lg shadow-lg;
		}
	}
}

/* === Status Indicator Utilities === */
@layer utilities {
	.status-online {
		background-color: hsl(var(--status-online));
	}

	.status-offline {
		background-color: hsl(var(--status-offline));
	}

	.status-pending {
		background-color: hsl(var(--status-pending));
		animation: pulse-status 2s infinite;
	}

	.status-idle {
		background-color: hsl(var(--status-idle));
	}

	/* Touch target enforcement (48px minimum) */
	.touch-target {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
	}

	/* Touch target with active state feedback */
	.touch-target-interactive {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
		@apply relative active:scale-95 transition-transform duration-75;
	}

	/* Touch-friendly gap between interactive elements */
	.touch-gap {
		gap: var(--touch-gap-min);
	}

	/* Thumb zone positioning (bottom of screen) */
	.thumb-zone {
		@apply fixed bottom-0 left-0 right-0 pb-safe;
	}

	/* Touch ripple effect */
	.touch-ripple {
		@apply relative overflow-hidden;
	}

	.touch-ripple::after {
		content: '';
		@apply absolute inset-0 bg-current opacity-0 transition-opacity duration-150;
	}

	.touch-ripple:active::after {
		@apply opacity-10;
	}

	/* === Safe Area Insets (notched devices) === */
	.pt-safe {
		padding-top: env(safe-area-inset-top, 0px);
	}

	.pb-safe {
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.pl-safe {
		padding-left: env(safe-area-inset-left, 0px);
	}

	.pr-safe {
		padding-right: env(safe-area-inset-right, 0px);
	}

	.px-safe {
		padding-left: env(safe-area-inset-left, 0px);
		padding-right: env(safe-area-inset-right, 0px);
	}

	.py-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.p-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-right: env(safe-area-inset-right, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
		padding-left: env(safe-area-inset-left, 0px);
	}

	/* Safe area margins */
	.mt-safe {
		margin-top: env(safe-area-inset-top, 0px);
	}

	.mb-safe {
		margin-bottom: env(safe-area-inset-bottom, 0px);
	}

	/* Min-height accounting for safe areas */
	.min-h-safe-screen {
		min-height: calc(100vh - env(safe-area-inset-top, 0px) - env(safe-area-inset-bottom, 0px));
	}

	/* Focus visible ring */
	.focus-ring {
		@apply outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
	}

	/* === Live Regions for Screen Readers === */
	/* Assertive announcements (interrupts) */
	.sr-alert {
		@apply sr-only;
	}

	/* Polite announcements (waits for pause) */
	.sr-status {
		@apply sr-only;
	}

	/* Log region for activity feeds */
	.sr-log {
		@apply sr-only;
	}

	/* Visible live region (shows content) */
	.live-region {
		/* No visual styles - just semantic */
	}

	/* Screen reader only - hidden visually but accessible */
	.sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border-width: 0;
	}

	/* Make sr-only visible on focus (for skip links) */
	.sr-only-focusable:focus {
		position: static;
		width: auto;
		height: auto;
		padding: inherit;
		margin: inherit;
		overflow: visible;
		clip: auto;
		white-space: normal;
	}

	/* Individual stagger delay classes (for manual control) */
	.stagger-0 { animation-delay: 0ms; animation-fill-mode: both; }
	.stagger-1 { animation-delay: calc(1 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-2 { animation-delay: calc(2 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-3 { animation-delay: calc(3 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-4 { animation-delay: calc(4 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-5 { animation-delay: calc(5 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-6 { animation-delay: calc(6 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-7 { animation-delay: calc(7 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-8 { animation-delay: calc(8 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
}

/* === Typography Scale === */
/* Standardized text styles for consistent visual hierarchy */
@layer components {
	/* H1: Large page titles (desktop: 24px, mobile: 24px) */
	.h1 {
		@apply text-2xl font-semibold leading-tight;
	}

	/* H2: Section titles (desktop: 20px, mobile: 20px) */
	.h2 {
		@apply text-xl font-semibold leading-relaxed;
	}

	/* H3: Subsection titles (16px) */
	.h3 {
		@apply text-base font-medium leading-relaxed;
	}

	/* Body text: Standard reading text (14px, 1.5 line-height) */
	.body-text {
		@apply text-sm font-normal leading-relaxed;
	}

	/* Small text: Captions, secondary text (12px, 1.4 line-height) */
	.body-small {
		@apply text-xs font-normal leading-relaxed;
	}

	/* Code/Monospace: Code blocks, technical text (13px, JetBrains Mono) */
	.code-text {
		@apply text-code font-mono;
	}

	/* Section label: Field labels, uppercase (10px, 0.1em tracking) */
	.label-section {
		@apply text-2xs font-normal uppercase tracking-widest text-muted-foreground;
	}

	/* Alternative typography utility classes for common patterns */
	
	/* Large label text (commonly used in forms) */
	.label-lg {
		@apply text-sm font-medium leading-normal;
	}

	/* Medium label text */
	.label-md {
		@apply text-xs font-medium leading-normal;
	}

	/* Small label text */
	.label-sm {
		@apply text-2xs font-medium leading-tight uppercase tracking-wide;
	}

	/* Inline code (used within body text) */
	.code-inline {
		@apply px-1.5 py-0.5 bg-muted rounded text-code font-mono;
	}

	/* Heading text (semantic alternative to h1/h2/h3) */
	.heading-1 {
		@apply text-2xl font-semibold leading-tight;
	}

	.heading-2 {
		@apply text-xl font-semibold leading-relaxed;
	}

	.heading-3 {
		@apply text-base font-medium leading-relaxed;
	}
}

/* === Stagger Animation Container === */
/* Apply .stagger to parent, children get automatic staggered delays */
@layer components {
	.stagger > * {
		animation-fill-mode: both;
	}

	.stagger > *:nth-child(1) { animation-delay: calc(0 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(2) { animation-delay: calc(1 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(3) { animation-delay: calc(2 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(4) { animation-delay: calc(3 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(5) { animation-delay: calc(4 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(6) { animation-delay: calc(5 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(7) { animation-delay: calc(6 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(8) { animation-delay: calc(7 * var(--delay-stagger, 50ms)); }

	/* For items beyond 8, use CSS var set by JS utility */
	.stagger > *:nth-child(n+9) {
		animation-delay: var(--stagger-delay, calc(8 * var(--delay-stagger, 50ms)));
	}
}

/* === Keyframe Animations === */
@keyframes pulse-status {
	0%, 100% {
		opacity: 1;
	}
	50% {
		opacity: 0.5;
	}
}

/* === Animation Performance: will-change hints === */
/* Applied judiciously to animated elements for compositor layer promotion */
@layer utilities {
	/* Blur-fade animations: promote to compositor layer during animation */
	.animate-blur-fade-up,
	.animate-blur-fade-down,
	.animate-blur-fade-left,
	.animate-blur-fade-right {
		will-change: transform, opacity;
	}

	/* Scale animations */
	.animate-scale-in,
	.animate-scale-out {
		will-change: transform, opacity;
	}

	/* Slide animations */
	.animate-slide-in-up,
	.animate-slide-in-down,
	.animate-slide-in-left,
	.animate-slide-in-right {
		will-change: transform, opacity;
	}

	/* Spin animation */
	.animate-spin,
	.animate-spin-slow,
	.animate-spin-fast {
		will-change: transform;
	}

	/* Remove will-change after animation completes to free memory */
	/* For one-shot animations, use animation-fill-mode: forwards and JS cleanup */
}

/* === Performant Glow Pulse Effect === */
/* Uses opacity (composited) instead of animating box-shadow (triggers repaint) */
@layer components {
	.glow-pulse-effect {
		position: relative;
		/* Set color for the glow to inherit from */
		color: hsl(var(--status-online));
	}

	.glow-pulse-effect::before {
		content: '';
		position: absolute;
		inset: -4px;
		border-radius: inherit;
		background: currentColor;
		filter: blur(8px);
		animation: glow-pulse 2s ease-in-out infinite;
		will-change: opacity;
		z-index: -1;
	}

	/* Primary color glow variant */
	.glow-pulse-effect-primary {
		color: hsl(var(--primary));
	}
}

/* === Performant Shimmer Effect === */
/* Uses transform (composited) instead of backgroundPosition (triggers repaint) */
/* Updated: 1.5s duration, subtler gradient (0.06 opacity) per Loading States spec */
@layer components {
	.shimmer-effect {
		position: relative;
		overflow: hidden;
		background: hsl(var(--muted));
	}

	.shimmer-effect::after {
		content: '';
		position: absolute;
		inset: 0;
		background: linear-gradient(
			90deg,
			transparent 0%,
			hsl(var(--muted-foreground) / 0.06) 50%,
			transparent 100%
		);
		transform: translateX(-100%);
		animation: shimmer 1.5s infinite linear;
		will-change: transform;
	}

	/* Skeleton loading container with staggered children */
	.skeleton-group {
		/* Children get staggered delays automatically */
	}

	.skeleton-group > * {
		animation-fill-mode: both;
	}

	.skeleton-group > *:nth-child(1) { animation-delay: calc(0 * 50ms); }
	.skeleton-group > *:nth-child(2) { animation-delay: calc(1 * 50ms); }
	.skeleton-group > *:nth-child(3) { animation-delay: calc(2 * 50ms); }
	.skeleton-group > *:nth-child(4) { animation-delay: calc(3 * 50ms); }
	.skeleton-group > *:nth-child(5) { animation-delay: calc(4 * 50ms); }
	.skeleton-group > *:nth-child(6) { animation-delay: calc(5 * 50ms); }
	.skeleton-group > *:nth-child(7) { animation-delay: calc(6 * 50ms); }
	.skeleton-group > *:nth-child(8) { animation-delay: calc(7 * 50ms); }
}

/* === Reduced Motion Preference === */
@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-delay: 0ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}

	.status-pending {
		animation: none;
	}

	/* Remove stagger delays */
	.stagger > *,
	[class*="stagger-"] {
		animation-delay: 0ms !important;
	}

	/* Show static alternatives for animated elements */
	.motion-safe\\:hidden {
		display: block !important;
	}

	.motion-safe\\:block {
		display: none !important;
	}

	/* Replace blur animations with opacity fade */
	[class*="blur-fade"] {
		filter: none !important;
		animation: fade-in 0.01ms !important;
	}

	/* Disable shimmer effect */
	.animate-shimmer,
	.shimmer-effect::after {
		animation: none !important;
		transform: none !important;
	}

	/* Hide shimmer overlay in reduced motion */
	.shimmer-effect::after {
		display: none !important;
	}

	/* Replace glow pulse with static glow */
	.animate-glow-pulse,
	.glow-pulse-effect::before {
		animation: none !important;
		opacity: 0.7 !important;
	}

	/* Remove will-change in reduced motion (no animations = no need for layer promotion) */
	[class*="animate-"],
	.shimmer-effect::after,
	.glow-pulse-effect::before {
		will-change: auto !important;
	}
}

/* Utility classes for motion-aware components */
@media (prefers-reduced-motion: no-preference) {
	.motion-reduce\\:hidden {
		display: none;
	}
}

/* === Link Hover Underline Animation === */
/* Animated underline effect for links - slides in from left on hover */
@layer components {
	.link-underline {
		@apply relative inline-block text-foreground no-underline;
		background: linear-gradient(
			to right,
			hsl(var(--primary)) 0%,
			hsl(var(--primary)) 100%
		);
		background-size: 0% 2px;
		background-repeat: no-repeat;
		background-position: left bottom;
		transition: background-size var(--duration-normal) var(--ease-out);
	}

	.link-underline:hover,
	.link-underline:focus-visible {
		background-size: 100% 2px;
	}

	/* Variant: slides in from center */
	.link-underline-center {
		@apply relative inline-block text-foreground no-underline;
		background: linear-gradient(
			to right,
			hsl(var(--primary)) 0%,
			hsl(var(--primary)) 100%
		);
		background-size: 0% 2px;
		background-repeat: no-repeat;
		background-position: center bottom;
		transition: background-size var(--duration-normal) var(--ease-out);
	}

	.link-underline-center:hover,
	.link-underline-center:focus-visible {
		background-size: 100% 2px;
	}

	/* Variant: subtle muted color */
	.link-underline-muted {
		@apply relative inline-block text-muted-foreground no-underline;
		background: linear-gradient(
			to right,
			hsl(var(--muted-foreground)) 0%,
			hsl(var(--muted-foreground)) 100%
		);
		background-size: 0% 1px;
		background-repeat: no-repeat;
		background-position: left bottom;
		transition: background-size var(--duration-normal) var(--ease-out), color var(--duration-fast);
	}

	.link-underline-muted:hover,
	.link-underline-muted:focus-visible {
		@apply text-foreground;
		background-size: 100% 1px;
	}
}

/* === Scrollbar Styling === */
::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-track {
	background: transparent;
}

::-webkit-scrollbar-thumb {
	background: hsl(var(--border));
	border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
	background: hsl(var(--muted-foreground) / 0.5);
}

/* Firefox scrollbar */
* {
	scrollbar-width: thin;
	scrollbar-color: hsl(var(--border)) transparent;
}

/* === Responsive Layout Bug Fixes (UI-023) === */
/* Prevent horizontal overflow on mobile/tablet */

/* Cards: constrain width and prevent overflow */
.panel-glass {
	max-width: 100%;
	overflow: hidden;
}

/* Generic card/container overflow fix */
[class*="card"],
[class*="panel"],
[class*="container"] {
	max-width: 100%;
	overflow: hidden;
}

/* Ensure tables and code blocks scroll within their container, not the page */
table {
	max-width: 100%;
	overflow-x: auto;
}

code {
	max-width: 100%;
	overflow-x: auto;
	display: block;
}

pre {
	max-width: 100%;
	overflow-x: auto;
}

/* Prevent flex children from overflowing */
.flex {
	min-width: 0;
}

.grid {
	min-width: 0;
}

/* === Dynamic Viewport Height (Safari mobile toolbar fix) === */
@layer utilities {
	.h-dvh {
		height: 100vh;    /* Fallback for older browsers */
		height: 100dvh;   /* Dynamic viewport height */
	}

	.min-h-dvh {
		min-height: 100vh;
		min-height: 100dvh;
	}

	/* Safe area padding for notched devices */
	.pb-safe {
		padding-bottom: env(safe-area-inset-bottom, 0);
	}

	.pt-safe {
		padding-top: env(safe-area-inset-top, 0);
	}
}

/* === Vim-Style Keyboard Navigation === */
@layer components {
	/* Vim selected item highlight */
	.vim-selected,
	[data-vim-selected="true"] {
		@apply ring-2 ring-primary ring-offset-2 ring-offset-background;
		outline: none;
	}

	/* Vim checked/selected for multi-select */
	[data-vim-checked="true"] {
		@apply bg-primary/10;
	}

	/* Vim sequence indicator (shows pending key like "g") */
	.vim-sequence-indicator {
		@apply fixed bottom-4 right-4 z-50 px-3 py-2 rounded-lg bg-card border border-border shadow-lg;
		@apply font-mono text-sm text-foreground;
		animation: vim-sequence-appear 0.15s ease-out;
	}

	@keyframes vim-sequence-appear {
		from {
			opacity: 0;
			transform: translateY(8px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	/* List items that can be navigated with j/k */
	[data-list-item] {
		@apply transition-all duration-75;
		cursor: pointer;
	}

	[data-list-item]:focus-visible {
		@apply ring-2 ring-primary ring-offset-2 ring-offset-background outline-none;
	}
}
