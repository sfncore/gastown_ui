/**
 * Utility Styles
 *
 * Helper classes: typography, gradients, status indicators,
 * touch targets, safe areas, accessibility, viewport heights.
 */

/* === Typography Utility Classes === */
@layer utilities {
	/* Numeric Typography (tabular figures for aligned numbers) */
	.tabular-nums {
		font-variant-numeric: tabular-nums;
	}

	.proportional-nums {
		font-variant-numeric: proportional-nums;
	}

	.oldstyle-nums {
		font-variant-numeric: oldstyle-nums;
	}

	.lining-nums {
		font-variant-numeric: lining-nums;
	}

	/* Numeric utilities for dashboards/stats */
	.numeric {
		font-family: var(--font-mono);
		font-variant-numeric: tabular-nums;
		font-feature-settings: 'tnum' 1;
	}

	/* Truncate utilities */
	.line-clamp-1 {
		display: -webkit-box;
		-webkit-line-clamp: 1;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-2 {
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.line-clamp-3 {
		display: -webkit-box;
		-webkit-line-clamp: 3;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	/* Text balance for headlines */
	.text-balance {
		text-wrap: balance;
	}

	.text-pretty {
		text-wrap: pretty;
	}
}

/* === Surface Gradient Utilities === */
@layer utilities {
	/* Apply surface gradients for depth */
	.gradient-surface {
		background: var(--gradient-surface);
	}

	.gradient-surface-subtle {
		background: var(--gradient-surface-subtle);
	}

	.gradient-shine {
		position: relative;
	}

	.gradient-shine::before {
		content: '';
		position: absolute;
		inset: 0;
		background: var(--gradient-shine);
		border-radius: inherit;
		pointer-events: none;
	}

	.gradient-overlay {
		background: var(--gradient-overlay);
	}

	/* Gradient border (for subtle depth effect) */
	.gradient-border {
		position: relative;
		background: hsl(var(--card));
		border-radius: var(--radius);
	}

	.gradient-border::before {
		content: '';
		position: absolute;
		inset: 0;
		padding: 1px;
		background: var(--gradient-border);
		border-radius: inherit;
		-webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
		-webkit-mask-composite: xor;
		mask-composite: exclude;
		pointer-events: none;
	}
}

/* === Status Indicator Utilities === */
@layer utilities {
	.status-online {
		background-color: hsl(var(--status-online));
	}

	.status-offline {
		background-color: hsl(var(--status-offline));
	}

	.status-pending {
		background-color: hsl(var(--status-pending));
		animation: pulse-status 2s infinite;
	}

	.status-idle {
		background-color: hsl(var(--status-idle));
	}

	/* Touch target enforcement (48px minimum) */
	.touch-target {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
	}

	/* Touch target with active state feedback */
	.touch-target-interactive {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
		@apply relative active:scale-95 transition-transform duration-75;
	}

	/* Touch-friendly gap between interactive elements */
	.touch-gap {
		gap: var(--touch-gap-min);
	}

	/* Thumb zone positioning (bottom of screen) */
	.thumb-zone {
		@apply fixed bottom-0 left-0 right-0 pb-safe;
	}

	/* Touch ripple effect */
	.touch-ripple {
		@apply relative overflow-hidden;
	}

	.touch-ripple::after {
		content: '';
		@apply absolute inset-0 bg-current opacity-0 transition-opacity duration-150;
	}

	.touch-ripple:active::after {
		@apply opacity-10;
	}

	/* === Safe Area Insets (notched devices) === */
	.pt-safe {
		padding-top: env(safe-area-inset-top, 0px);
	}

	.pb-safe {
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.pl-safe {
		padding-left: env(safe-area-inset-left, 0px);
	}

	.pr-safe {
		padding-right: env(safe-area-inset-right, 0px);
	}

	.px-safe {
		padding-left: env(safe-area-inset-left, 0px);
		padding-right: env(safe-area-inset-right, 0px);
	}

	.py-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.p-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-right: env(safe-area-inset-right, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
		padding-left: env(safe-area-inset-left, 0px);
	}

	/* Safe area margins */
	.mt-safe {
		margin-top: env(safe-area-inset-top, 0px);
	}

	.mb-safe {
		margin-bottom: env(safe-area-inset-bottom, 0px);
	}

	/* Min-height accounting for safe areas */
	.min-h-safe-screen {
		min-height: calc(100vh - env(safe-area-inset-top, 0px) - env(safe-area-inset-bottom, 0px));
	}

	/* Focus visible ring */
	.focus-ring {
		@apply outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
	}

	/* === Live Regions for Screen Readers === */
	/* Assertive announcements (interrupts) */
	.sr-alert {
		@apply sr-only;
	}

	/* Polite announcements (waits for pause) */
	.sr-status {
		@apply sr-only;
	}

	/* Log region for activity feeds */
	.sr-log {
		@apply sr-only;
	}

	/* Visible live region (shows content) */
	.live-region {
		/* No visual styles - just semantic */
	}

	/* Screen reader only - hidden visually but accessible */
	.sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border-width: 0;
	}

	/* Make sr-only visible on focus (for skip links) */
	.sr-only-focusable:focus {
		position: static;
		width: auto;
		height: auto;
		padding: inherit;
		margin: inherit;
		overflow: visible;
		clip: auto;
		white-space: normal;
	}

	/* Individual stagger delay classes (for manual control) */
	.stagger-0 { animation-delay: 0ms; animation-fill-mode: both; }
	.stagger-1 { animation-delay: calc(1 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-2 { animation-delay: calc(2 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-3 { animation-delay: calc(3 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-4 { animation-delay: calc(4 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-5 { animation-delay: calc(5 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-6 { animation-delay: calc(6 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-7 { animation-delay: calc(7 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-8 { animation-delay: calc(8 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
}

/* === Dynamic Viewport Height (Safari mobile toolbar fix) === */
@layer utilities {
	.h-dvh {
		height: 100vh;    /* Fallback for older browsers */
		height: 100dvh;   /* Dynamic viewport height */
	}

	.min-h-dvh {
		min-height: 100vh;
		min-height: 100dvh;
	}
}
