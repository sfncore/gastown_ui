@tailwind base;
@tailwind components;
@tailwind utilities;

/**
 * Gas Town Design System - CSS Custom Properties
 *
 * This file implements shadcn/ui design tokens for SvelteKit.
 * All colors use HSL format without the hsl() wrapper for Tailwind alpha support.
 *
 * Token Categories:
 * ─────────────────────────────────────────────────────────────────────────────
 * CORE SEMANTIC (shadcn standard):
 *   --background, --foreground      Base surface and text colors
 *   --card, --card-foreground       Card surfaces
 *   --popover, --popover-foreground Floating elements
 *   --primary, --primary-foreground Brand/action color
 *   --secondary, --secondary-foreground Secondary actions
 *   --muted, --muted-foreground     Subtle backgrounds/text
 *   --accent, --accent-foreground   Highlights/hover states
 *   --destructive, --destructive-foreground Error/danger states
 *   --border                        Default border color
 *   --input                         Form input borders
 *   --ring                          Focus ring color
 *   --radius                        Default border radius
 *
 * EXTENDED (Gas Town specific):
 *   --success, --warning, --info    Semantic feedback colors
 *   --status-online/offline/pending/idle  Agent status indicators
 *   --shadow-*                      Elevation shadows
 *   --duration-*, --ease-*          Animation tokens
 *   --space-*                       Spacing scale (4px grid)
 *   --touch-target-min              WCAG 2.5.5 touch target (48px)
 *
 * Theme Switching:
 *   Light theme: :root selector
 *   Dark theme: .dark class (toggled via JS)
 *
 * Usage in Components:
 *   - Use Tailwind classes: bg-background, text-foreground, border-border
 *   - Or CSS: background: hsl(var(--background));
 *   - Never use hardcoded hex/rgb values in components
 * ─────────────────────────────────────────────────────────────────────────────
 */

@layer base {
	:root {
		/* === Gas Town Design System === */
		/* Primary: #EF6F2E | Accent: #6A7282 | Background: #F8F8F8 | Text: #020202 */

		/* Core colors */
		--background: 0 0% 97%;
		--foreground: 0 0% 1%;
		--card: 0 0% 100%;
		--card-foreground: 0 0% 1%;
		--popover: 0 0% 100%;
		--popover-foreground: 0 0% 1%;
		--primary: 18 86% 56%;
		--primary-foreground: 0 0% 100%;
		--secondary: 220 10% 92%;
		--secondary-foreground: 0 0% 1%;
		--muted: 220 10% 92%;
		--muted-foreground: 220 10% 40%;
		--accent: 220 10% 46%;
		--accent-foreground: 0 0% 100%;
		--destructive: 0 84% 60%;
		--destructive-foreground: 0 0% 100%;
		--border: 220 10% 85%;
		--input: 220 10% 88%;
		--ring: 18 86% 56%;
		--radius: 0.5rem;

		/* === Typography === */
		--font-sans: 'Inter', system-ui, -apple-system, sans-serif;
		--font-mono: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace;

		/* === Spacing Scale (based on 4px grid) === */
		--space-1: 0.25rem;  /* 4px */
		--space-2: 0.5rem;   /* 8px */
		--space-3: 0.75rem;  /* 12px */
		--space-4: 1rem;     /* 16px */
		--space-5: 1.25rem;  /* 20px */
		--space-6: 1.5rem;   /* 24px */
		--space-7: 1.75rem;  /* 28px */
		--space-8: 2rem;     /* 32px */
		--space-9: 2.25rem;  /* 36px */
		--space-10: 2.5rem;  /* 40px */
		--space-11: 2.75rem; /* 44px */
		--space-12: 3rem;    /* 48px */

		/* === Animation Tokens === */
		--duration-instant: 50ms;
		--duration-fast: 150ms;
		--duration-normal: 200ms;
		--duration-slow: 300ms;
		--duration-slower: 500ms;
		--ease-out: cubic-bezier(0.16, 1, 0.3, 1);
		--ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
		--ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
		--delay-stagger: 50ms;

		/* === Semantic Feedback Colors (HSL) === */
		--success: 160 84% 39%;
		--success-foreground: 0 0% 100%;
		--warning: 38 92% 50%;
		--warning-foreground: 0 0% 0%;
		--info: 199 89% 48%;
		--info-foreground: 0 0% 100%;

		/* === Status Colors (HSL) === */
		--status-online: 142 76% 36%;
		--status-offline: 0 84% 60%;
		--status-pending: 38 92% 50%;
		--status-idle: 220 9% 46%;

		/* === Shadow Tokens === */
		--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.04);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.05);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.04);
		--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.08), 0 8px 10px -6px rgb(0 0 0 / 0.04);
		--shadow-glow: 0 0 20px -5px hsl(var(--primary) / 0.4);
		--shadow-focus: 0 0 0 3px hsl(var(--ring) / 0.25);

		/* === Touch Target (WCAG 2.5.5 AAA: 44px, enhanced: 48px) === */
		--touch-target-min: 48px;
		--touch-gap-min: 8px;
	}

	.dark {
		--background: 0 0% 4%;
		--foreground: 0 0% 95%;
		--card: 0 0% 7%;
		--card-foreground: 0 0% 95%;
		--popover: 0 0% 7%;
		--popover-foreground: 0 0% 95%;
		--primary: 18 86% 58%;
		--primary-foreground: 0 0% 0%;
		--secondary: 0 0% 14%;
		--secondary-foreground: 0 0% 95%;
		--muted: 0 0% 14%;
		--muted-foreground: 0 0% 60%;
		--accent: 220 10% 22%;
		--accent-foreground: 0 0% 95%;
		--destructive: 0 62% 35%;
		--destructive-foreground: 0 0% 95%;
		--border: 0 0% 16%;
		--input: 0 0% 14%;
		--ring: 18 86% 58%;

		--success: 160 84% 39%;
		--success-foreground: 0 0% 100%;
		--warning: 38 92% 50%;
		--warning-foreground: 0 0% 0%;
		--info: 199 89% 48%;
		--info-foreground: 0 0% 100%;

		--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.4);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.5), 0 2px 4px -2px rgb(0 0 0 / 0.4);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.5), 0 4px 6px -4px rgb(0 0 0 / 0.4);
		--shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.5), 0 8px 10px -6px rgb(0 0 0 / 0.4);
		--shadow-glow: 0 0 30px -5px hsl(var(--primary) / 0.5);
	}
}

@layer base {
	* {
		@apply border-border;
	}

	body {
		@apply bg-background text-foreground;
		font-family: var(--font-sans);
		font-feature-settings: 'rlig' 1, 'calt' 1;
	}

	code, pre, .font-mono {
		font-family: var(--font-mono);
	}
}

/* === Glass Morphism Utilities === */
@layer components {
	/* Standard glass panel - subtle blur with semi-transparent background */
	.panel-glass {
		@apply bg-background/80 backdrop-blur-xl border border-border rounded-lg;
	}

	/* Strong glass panel - more pronounced blur effect */
	.panel-glass-strong {
		@apply bg-background/90 backdrop-blur-2xl border border-border rounded-lg;
	}

	/* Glass card variant - for elevated surfaces */
	.card-glass {
		@apply bg-card/80 backdrop-blur-xl border border-border rounded-lg shadow-md;
	}

	/* Glass popover variant - for floating elements */
	.popover-glass {
		@apply bg-popover/85 backdrop-blur-xl border border-border rounded-lg shadow-lg;
	}

	/* Fallback for browsers without backdrop-filter support (checks both standard and webkit) */
	@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
		.panel-glass {
			@apply bg-background/95 border border-border rounded-lg;
		}

		.panel-glass-strong {
			@apply bg-background border border-border rounded-lg;
		}

		.card-glass {
			@apply bg-card/95 border border-border rounded-lg shadow-md;
		}

		.popover-glass {
			@apply bg-popover/95 border border-border rounded-lg shadow-lg;
		}
	}
}

/* === Status Indicator Utilities === */
@layer utilities {
	.status-online {
		background-color: hsl(var(--status-online));
	}

	.status-offline {
		background-color: hsl(var(--status-offline));
	}

	.status-pending {
		background-color: hsl(var(--status-pending));
		animation: pulse-status 2s infinite;
	}

	.status-idle {
		background-color: hsl(var(--status-idle));
	}

	/* Touch target enforcement (48px minimum) */
	.touch-target {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
	}

	/* Touch target with active state feedback */
	.touch-target-interactive {
		min-height: var(--touch-target-min);
		min-width: var(--touch-target-min);
		@apply relative active:scale-95 transition-transform duration-75;
	}

	/* Touch-friendly gap between interactive elements */
	.touch-gap {
		gap: var(--touch-gap-min);
	}

	/* Thumb zone positioning (bottom of screen) */
	.thumb-zone {
		@apply fixed bottom-0 left-0 right-0 pb-safe;
	}

	/* Touch ripple effect */
	.touch-ripple {
		@apply relative overflow-hidden;
	}

	.touch-ripple::after {
		content: '';
		@apply absolute inset-0 bg-current opacity-0 transition-opacity duration-150;
	}

	.touch-ripple:active::after {
		@apply opacity-10;
	}

	/* === Safe Area Insets (notched devices) === */
	.pt-safe {
		padding-top: env(safe-area-inset-top, 0px);
	}

	.pb-safe {
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.pl-safe {
		padding-left: env(safe-area-inset-left, 0px);
	}

	.pr-safe {
		padding-right: env(safe-area-inset-right, 0px);
	}

	.px-safe {
		padding-left: env(safe-area-inset-left, 0px);
		padding-right: env(safe-area-inset-right, 0px);
	}

	.py-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
	}

	.p-safe {
		padding-top: env(safe-area-inset-top, 0px);
		padding-right: env(safe-area-inset-right, 0px);
		padding-bottom: env(safe-area-inset-bottom, 0px);
		padding-left: env(safe-area-inset-left, 0px);
	}

	/* Safe area margins */
	.mt-safe {
		margin-top: env(safe-area-inset-top, 0px);
	}

	.mb-safe {
		margin-bottom: env(safe-area-inset-bottom, 0px);
	}

	/* Min-height accounting for safe areas */
	.min-h-safe-screen {
		min-height: calc(100vh - env(safe-area-inset-top, 0px) - env(safe-area-inset-bottom, 0px));
	}

	/* Focus visible ring */
	.focus-ring {
		@apply outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
	}

	/* === Live Regions for Screen Readers === */
	/* Assertive announcements (interrupts) */
	.sr-alert {
		@apply sr-only;
	}

	/* Polite announcements (waits for pause) */
	.sr-status {
		@apply sr-only;
	}

	/* Log region for activity feeds */
	.sr-log {
		@apply sr-only;
	}

	/* Visible live region (shows content) */
	.live-region {
		/* No visual styles - just semantic */
	}

	/* Screen reader only - hidden visually but accessible */
	.sr-only {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border-width: 0;
	}

	/* Make sr-only visible on focus (for skip links) */
	.sr-only-focusable:focus {
		position: static;
		width: auto;
		height: auto;
		padding: inherit;
		margin: inherit;
		overflow: visible;
		clip: auto;
		white-space: normal;
	}

	/* Individual stagger delay classes (for manual control) */
	.stagger-0 { animation-delay: 0ms; animation-fill-mode: both; }
	.stagger-1 { animation-delay: calc(1 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-2 { animation-delay: calc(2 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-3 { animation-delay: calc(3 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-4 { animation-delay: calc(4 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-5 { animation-delay: calc(5 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-6 { animation-delay: calc(6 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-7 { animation-delay: calc(7 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
	.stagger-8 { animation-delay: calc(8 * var(--delay-stagger, 50ms)); animation-fill-mode: both; }
}

/* === Stagger Animation Container === */
/* Apply .stagger to parent, children get automatic staggered delays */
@layer components {
	.stagger > * {
		animation-fill-mode: both;
	}

	.stagger > *:nth-child(1) { animation-delay: calc(0 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(2) { animation-delay: calc(1 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(3) { animation-delay: calc(2 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(4) { animation-delay: calc(3 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(5) { animation-delay: calc(4 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(6) { animation-delay: calc(5 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(7) { animation-delay: calc(6 * var(--delay-stagger, 50ms)); }
	.stagger > *:nth-child(8) { animation-delay: calc(7 * var(--delay-stagger, 50ms)); }

	/* For items beyond 8, use CSS var set by JS utility */
	.stagger > *:nth-child(n+9) {
		animation-delay: var(--stagger-delay, calc(8 * var(--delay-stagger, 50ms)));
	}
}

/* === Keyframe Animations === */
@keyframes pulse-status {
	0%, 100% {
		opacity: 1;
	}
	50% {
		opacity: 0.5;
	}
}

/* === Animation Performance: will-change hints === */
/* Applied judiciously to animated elements for compositor layer promotion */
@layer utilities {
	/* Blur-fade animations: promote to compositor layer during animation */
	.animate-blur-fade-up,
	.animate-blur-fade-down,
	.animate-blur-fade-left,
	.animate-blur-fade-right {
		will-change: transform, opacity;
	}

	/* Scale animations */
	.animate-scale-in,
	.animate-scale-out {
		will-change: transform, opacity;
	}

	/* Slide animations */
	.animate-slide-in-up,
	.animate-slide-in-down,
	.animate-slide-in-left,
	.animate-slide-in-right {
		will-change: transform, opacity;
	}

	/* Spin animation */
	.animate-spin,
	.animate-spin-slow,
	.animate-spin-fast {
		will-change: transform;
	}

	/* Remove will-change after animation completes to free memory */
	/* For one-shot animations, use animation-fill-mode: forwards and JS cleanup */
}

/* === Performant Glow Pulse Effect === */
/* Uses opacity (composited) instead of animating box-shadow (triggers repaint) */
@layer components {
	.glow-pulse-effect {
		position: relative;
		/* Set color for the glow to inherit from */
		color: hsl(var(--status-online));
	}

	.glow-pulse-effect::before {
		content: '';
		position: absolute;
		inset: -4px;
		border-radius: inherit;
		background: currentColor;
		filter: blur(8px);
		animation: glow-pulse 2s ease-in-out infinite;
		will-change: opacity;
		z-index: -1;
	}

	/* Primary color glow variant */
	.glow-pulse-effect-primary {
		color: hsl(var(--primary));
	}
}

/* === Performant Shimmer Effect === */
/* Uses transform (composited) instead of backgroundPosition (triggers repaint) */
@layer components {
	.shimmer-effect {
		position: relative;
		overflow: hidden;
		background: hsl(var(--muted));
	}

	.shimmer-effect::after {
		content: '';
		position: absolute;
		inset: 0;
		background: linear-gradient(
			90deg,
			transparent 0%,
			hsl(var(--muted-foreground) / 0.1) 50%,
			transparent 100%
		);
		transform: translateX(-100%);
		animation: shimmer 2s infinite linear;
		will-change: transform;
	}
}

/* === Reduced Motion Preference === */
@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-delay: 0ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}

	.status-pending {
		animation: none;
	}

	/* Remove stagger delays */
	.stagger > *,
	[class*="stagger-"] {
		animation-delay: 0ms !important;
	}

	/* Show static alternatives for animated elements */
	.motion-safe\\:hidden {
		display: block !important;
	}

	.motion-safe\\:block {
		display: none !important;
	}

	/* Replace blur animations with opacity fade */
	[class*="blur-fade"] {
		filter: none !important;
		animation: fade-in 0.01ms !important;
	}

	/* Disable shimmer effect */
	.animate-shimmer,
	.shimmer-effect::after {
		animation: none !important;
		transform: none !important;
	}

	/* Hide shimmer overlay in reduced motion */
	.shimmer-effect::after {
		display: none !important;
	}

	/* Replace glow pulse with static glow */
	.animate-glow-pulse,
	.glow-pulse-effect::before {
		animation: none !important;
		opacity: 0.7 !important;
	}

	/* Remove will-change in reduced motion (no animations = no need for layer promotion) */
	[class*="animate-"],
	.shimmer-effect::after,
	.glow-pulse-effect::before {
		will-change: auto !important;
	}
}

/* Utility classes for motion-aware components */
@media (prefers-reduced-motion: no-preference) {
	.motion-reduce\\:hidden {
		display: none;
	}
}

/* === Scrollbar Styling === */
::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

::-webkit-scrollbar-track {
	background: transparent;
}

::-webkit-scrollbar-thumb {
	background: hsl(var(--border));
	border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
	background: hsl(var(--muted-foreground) / 0.5);
}

/* Firefox scrollbar */
* {
	scrollbar-width: thin;
	scrollbar-color: hsl(var(--border)) transparent;
}
