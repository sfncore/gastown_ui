# Gastown UI

[![Contract Tests](https://github.com/Avyukth/gastown_ui/actions/workflows/contract-tests.yml/badge.svg)](https://github.com/Avyukth/gastown_ui/actions/workflows/contract-tests.yml)

Frontend for the Gas Town orchestration dashboard. This repo powers the
operator console for agents, convoys, merge activity, and system health.

## Features

- Multi-column dashboard with agents, workflows, queue, stats, and actions
- Agent detail pages with status, progress, and diagnostics
- Convoy tracking for batched work
- Work management (issues, convoys, sling targets)
- Logs, activity feed, rigs, settings, and health views

## Tech Stack

- SvelteKit + Vite
- Tailwind CSS + tailwind-variants
- lucide-svelte icons
- Bun or npm for tooling

## Screenshots

Add screenshots to `static/screenshots/` and reference here, for example:

```
![Dashboard](static/screenshots/dashboard.png)
```

## Quickstart

Requirements:
- Node.js 18+ (or Bun 1.1+)
- Git

Install dependencies:

```bash
bun install
```

Run the dev server:

```bash
bun run dev
```

Open `http://localhost:5173`.

## Build and Preview

```bash
bun run build
bun run preview
```

## Scripts

- `dev`: start local dev server
- `build`: production build
- `preview`: serve production build
- `check`: SvelteKit sync + typecheck
- `analyze`: build with bundle analyzer (`ANALYZE=true`)

## Repo Structure

```
src/
  lib/
    components/    Reusable UI components
    api/           Client utilities and API glue
    stores/        Client state and sockets
  routes/          SvelteKit pages and layouts
static/            Static assets
```

## Development Workflow

- Create a branch for each task.
- Keep changes scoped; update or add tests where applicable.
- Prefer reusable components in `src/lib/components`.
- Use semantic tokens from `src/app.css` and `tailwind.config.js`.

## Deployment

This is a standard SvelteKit/Vite build. Use your hosting providerâ€™s static
or node adapter flow as appropriate. The build output is generated by
`bun run build`.

## Contribution

- Keep commit messages concise.
- Avoid introducing new deps unless necessary.
- Maintain accessibility and keyboard support on interactive views.
- Follow the testing policy below.

## Testing Policy (Non-Negotiable)

Playwright is **not** used for this project.

Use **Claude in Chrome tools** for all UI verification and manual checks.
Do not introduce Playwright-based tests or references in plans or execution.

## Design System

Semantic tokens in `src/app.css` following shadcn conventions:

- **Core**: `--background`, `--foreground`, `--card`, `--muted`, `--border`
- **Status**: `--success`, `--warning`, `--info`, `--destructive`
- **Agent**: `--status-online`, `--status-offline`, `--status-pending`, `--status-idle`
- **Typography**: Inter (body), Space Grotesk (headlines), JetBrains Mono (code)
- **Utilities**: `.panel-glass`, `.touch-target`, `.stagger` animations

## Component Library

70+ components in `src/lib/components/` using Svelte 5 runes and `tailwind-variants`:

- **Core**: Button, Badge, Input, Switch, Icon
- **Layout**: DashboardLayout, PageHeader, SplitView
- **Status**: StatusIndicator, ProgressBar, Toast
- **Loading**: Skeleton, SkeletonGroup, NavigationLoader
- **A11y**: Announcer, LiveRegion, SkipLink, KeyboardHelpDialog
- **Mobile**: BottomNav, SwipeableItem, PullToRefresh, OfflineIndicator

## Utilities

- **Logger** (`$lib/utils/logger.ts`): Namespaced debug logging, environment-aware
- **Keyboard** (`$lib/utils/keyboard.ts`): Global shortcuts with platform detection
- **Gestures** (`$lib/utils/gestures.ts`): Swipe and pull-to-refresh detection

## Real-Time

WebSocket client (`$lib/stores/websocket.svelte.ts`) with:
- Exponential backoff reconnection (1s base, 30s max, 20% jitter)
- Heartbeat/ping-pong (30s interval, 5s timeout)
- Browser online/offline event integration

## Security

Configured in `src/hooks.server.ts`:
- CSP headers (self + fonts.googleapis.com)
- CSRF double-submit cookie pattern
- HttpOnly auth cookies
- Security headers (X-Frame-Options, HSTS in prod, etc.)

## Accessibility

- WCAG 2.5.5 AAA touch targets (48px min)
- Safe area insets for notched devices
- Screen reader live regions
- `prefers-reduced-motion` support

## Environment

```bash
VITE_WS_URL=ws://localhost:8080/ws
VITE_MOCK_API=true
```

## Notes

- `bun.lockb` is the Bun lockfile.
- `BUNDLE_ANALYSIS.md` documents the latest bundle audit.
# Test comment for refinery
